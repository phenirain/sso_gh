# üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ SSO API

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –í—ã–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ Prometheus
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω endpoint `/metrics` –Ω–∞ –ø–æ—Ä—Ç—É 8081
- ‚úÖ –§–æ—Ä–º–∞—Ç: Prometheus exposition format
- ‚úÖ Endpoint –¥–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `prometheus/client_golang`

### 2. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è 3 –º–µ—Ç—Ä–∏–∫ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
| # | –ú–µ—Ç—Ä–∏–∫–∞ | –¢–∏–ø | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | –õ–µ–≥–µ–Ω–¥–∞ |
|---|---------|-----|--------------|---------|
| 1 | HTTP Request Rate | Time Series | –õ–∏–Ω–µ–π–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ | last, max, mean |
| 2 | HTTP Request Duration | Time Series | –ü–µ—Ä—Ü–µ–Ω—Ç–∏–ª–∏ (p50, p95) | last, max, mean |
| 3 | HTTP Requests In-Flight | Gauge | –®–∫–∞–ª–∞ —Å –ø–æ—Ä–æ–≥–∞–º–∏ | lastNotNull |

### 3. –°–æ–∑–¥–∞–Ω–∏–µ 3 –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫

#### –ú–µ—Ç—Ä–∏–∫–∞ 1: Total Users (`sso_total_users`)
- **–¢–∏–ø**: Gauge
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**: Gauge (–∫—Ä—É–≥–æ–≤–∞—è —à–∫–∞–ª–∞)
- **–°–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å**: ‚úÖ **–î–ê** - —á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –ë–î –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫
- **–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ä–æ—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –±–∞–∑—ã

#### –ú–µ—Ç—Ä–∏–∫–∞ 2: Authentication Operations (`sso_auth_operations_total`)
- **–¢–∏–ø**: Counter
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (login, signup, refresh)
- **–ú–µ—Ç–∫–∏**: operation, status (success/failure)
- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**: Stacked Bars (—Ü–≤–µ—Ç–∞: –∑–µ–ª–µ–Ω—ã–π=success, –∫—Ä–∞—Å–Ω—ã–π=failure)
- **–õ–µ–≥–µ–Ω–¥–∞**: sum, last
- **–°–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å**: ‚ö†Ô∏è Counter —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ rate())
- **–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å**: –í—ã—è–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### –ú–µ—Ç—Ä–∏–∫–∞ 3: Active Sessions (`sso_active_sessions`)
- **–¢–∏–ø**: Gauge
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –¢–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–µ—Å—Å–∏–π
- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**: Gauge (–∫—Ä—É–≥–æ–≤–∞—è —à–∫–∞–ª–∞)
- **–°–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å**: ‚ÑπÔ∏è –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –Ω–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
- **–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ–∞–ª—å–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–∏—Å—Ç–µ–º—É

### 4. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫
- ‚úÖ Grafana Dashboard: "SSO API Metrics Dashboard"
- ‚úÖ 7 –ø–∞–Ω–µ–ª–µ–π —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ª–µ–≥–µ–Ω–¥—ã —Å –∫–ª—é—á–µ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### 5. –°–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å –º–µ—Ç—Ä–∏–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- ‚úÖ **sso_total_users**: –ü–æ–ª–Ω–∞—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å (—á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –ë–î)
- ‚úÖ **sso_database_records_total**: –ü–æ–ª–Ω–∞—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å (—á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –ë–î)
- ‚ÑπÔ∏è **sso_active_sessions**: –ß–∞—Å—Ç–∏—á–Ω–∞—è —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å (–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö)
- ‚ö†Ô∏è **Counter –º–µ—Ç—Ä–∏–∫–∏**: –°–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è (–Ω–æ Prometheus —Ö—Ä–∞–Ω–∏—Ç –∏—Å—Ç–æ—Ä–∏—é 7 –¥–Ω–µ–π)

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ö–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```
pkg/
‚îú‚îÄ‚îÄ metrics/
‚îÇ   ‚îú‚îÄ‚îÄ metrics.go          # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫
‚îÇ   ‚îî‚îÄ‚îÄ collector.go        # –°–±–æ—Ä—â–∏–∫ –º–µ—Ç—Ä–∏–∫ –∏–∑ –ë–î (–∫–∞–∂–¥—ã–µ 30 —Å–µ–∫)
‚îî‚îÄ‚îÄ echomiddleware/
    ‚îî‚îÄ‚îÄ metrics.go          # HTTP middleware –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
```
deployments/
‚îú‚îÄ‚îÄ docker-compose.yaml     # Docker Compose —Å Prometheus –∏ Grafana
‚îú‚îÄ‚îÄ prometheus/
‚îÇ   ‚îî‚îÄ‚îÄ prometheus.yml      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Prometheus (scrape –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫)
‚îî‚îÄ‚îÄ grafana/
    ‚îú‚îÄ‚îÄ provisioning/
    ‚îÇ   ‚îú‚îÄ‚îÄ datasources/    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Prometheus
    ‚îÇ   ‚îî‚îÄ‚îÄ dashboards/     # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞—à–±–æ—Ä–¥–æ–≤
    ‚îî‚îÄ‚îÄ dashboards/
        ‚îî‚îÄ‚îÄ sso-metrics.json # –î–∞—à–±–æ—Ä–¥ —Å 7 –ø–∞–Ω–µ–ª—è–º–∏
```

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```
‚îú‚îÄ‚îÄ MONITORING.md               # –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (50+ KB)
‚îú‚îÄ‚îÄ QUICKSTART_METRICS.md       # –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
‚îú‚îÄ‚îÄ METRICS_IMPLEMENTATION.md   # –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ SUMMARY.md                  # –≠—Ç–∞ —Å–≤–æ–¥–∫–∞
```

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
```
‚îú‚îÄ‚îÄ internal/application/server.go   # –î–æ–±–∞–≤–ª–µ–Ω /metrics endpoint
‚îú‚îÄ‚îÄ internal/application/auth/handler.go # –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ auth –æ–ø–µ—Ä–∞—Ü–∏–π
‚îú‚îÄ‚îÄ internal/run.go                  # –ó–∞–ø—É—Å–∫ metrics collector
‚îú‚îÄ‚îÄ pkg/echomiddleware/jwt.go        # /metrics –≤ skip list
‚îú‚îÄ‚îÄ Makefile                         # –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
‚îú‚îÄ‚îÄ go.mod / go.sum                  # –î–æ–±–∞–≤–ª–µ–Ω—ã Prometheus –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ docker-compose.yml               # Docker Compose –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
```

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç 1: Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
cd deployments
docker-compose up -d
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: Makefile
```bash
make docker_compose_up    # –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
make metrics_test         # –ü—Ä–æ–≤–µ—Ä–∫–∞ /metrics endpoint
make metrics_open         # –û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ
```

## üåê –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º

| –°–µ—Ä–≤–∏—Å | URL | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è |
|--------|-----|-------------|
| **SSO API** | http://localhost:8081 | JWT —Ç–æ–∫–µ–Ω—ã |
| **Swagger** | http://localhost:8081/swagger/index.html | –ù–µ—Ç |
| **Metrics** | http://localhost:8081/metrics | –ù–µ—Ç |
| **Prometheus** | http://localhost:9090 | –ù–µ—Ç |
| **Grafana** | http://localhost:3000 | admin/admin |

## üìä Grafana Dashboard

### –ü–∞–Ω–µ–ª–∏ (7 —à—Ç)

**–í–µ—Ä—Ö–Ω–∏–π —Ä—è–¥ - –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
1. HTTP Request Rate (Time Series)
2. HTTP Request Duration Percentiles (Time Series)

**–°—Ä–µ–¥–Ω–∏–π —Ä—è–¥ - –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
3. HTTP Requests In-Flight (Gauge) ‚≠ê
4. Total Registered Users (Gauge) ‚≠ê **–ö–∞—Å—Ç–æ–º–Ω–∞—è**
5. Active User Sessions (Gauge) ‚≠ê **–ö–∞—Å—Ç–æ–º–Ω–∞—è**

**–ù–∏–∂–Ω–∏–π —Ä—è–¥ - –ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏:**
6. Authentication Operations Rate (Stacked Bars) ‚≠ê **–ö–∞—Å—Ç–æ–º–Ω–∞—è**
7. Database Records Count (Time Series)

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

- ‚úÖ **–õ–æ–≥–∏—á–Ω—ã–µ —Ç–∏–ø—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤**: Gauge –¥–ª—è —Ç–µ–∫—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π, Time Series –¥–ª—è —Ç—Ä–µ–Ω–¥–æ–≤
- ‚úÖ **–¶–≤–µ—Ç–æ–≤–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞**: –ó–µ–ª–µ–Ω—ã–π (success), –ö—Ä–∞—Å–Ω—ã–π (failure), –°–∏–Ω–∏–π (–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ)
- ‚úÖ **–ü–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**: –î–ª—è In-Flight Requests (–∑–µ–ª–µ–Ω—ã–π <5, –∂–µ–ª—Ç—ã–π 5-10, –∫—Ä–∞—Å–Ω—ã–π >10)
- ‚úÖ **–õ–µ–≥–µ–Ω–¥—ã —Å –¥–∞–Ω–Ω—ã–º–∏**: last, max, mean, sum, min –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –º–µ—Ç—Ä–∏–∫–∏
- ‚úÖ **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ö–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—É–≤–µ–ª–∏—á–∏—Ç sso_total_users –∏ auth operations)
curl -X POST http://localhost:8081/auth/signUp \
  -H "Content-Type: application/json" \
  -d '{"login": "testuser1", "password": "pass123"}'

# –õ–æ–≥–∏–Ω (—É–≤–µ–ª–∏—á–∏—Ç auth operations –∏ active sessions)
curl -X POST http://localhost:8081/auth/logIn \
  -H "Content-Type: application/json" \
  -d '{"login": "testuser1", "password": "pass123"}'
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫
```bash
# –í—Å–µ –º–µ—Ç—Ä–∏–∫–∏
curl http://localhost:8081/metrics

# –ö–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
curl -s http://localhost:8081/metrics | grep -E 'sso_total_users|sso_auth_operations|sso_active_sessions'
```

## üìà –ü—Ä–∏–º–µ—Ä—ã PromQL –∑–∞–ø—Ä–æ—Å–æ–≤

```promql
# 1. –¢–µ–∫—É—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
sso_total_users

# 2. –†–æ—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ —á–∞—Å
delta(sso_total_users[1h])

# 3. Success rate –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (%)
100 * sum(rate(sso_auth_operations_total{status="success"}[5m])) /
sum(rate(sso_auth_operations_total[5m]))

# 4. Request rate –ø–æ endpoint'–∞–º
sum(rate(sso_http_requests_total[5m])) by (path)

# 5. –¢–æ–ø-5 –º–µ–¥–ª–µ–Ω–Ω—ã—Ö endpoints
topk(5, histogram_quantile(0.95, rate(sso_http_request_duration_seconds_bucket[5m])) by (path))

# 6. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ audit —Ç–∞–±–ª–∏—Ü–µ
sso_database_records_total{table="audit"}
```

## üéØ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∏–∑ –ë–î
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π goroutine
- –û–±–Ω–æ–≤–ª—è–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### 2. Middleware –¥–ª—è HTTP –º–µ—Ç—Ä–∏–∫
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π overhead (~0.1-0.5ms –Ω–∞ –∑–∞–ø—Ä–æ—Å)
- –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ /metrics endpoint (skip)

### 3. –Ø–≤–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫
- Auth operations: –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –≤ handler'–∞—Ö
- Active sessions: –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ JWT –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- Total users: —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ –ë–î –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏

### 4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ provisioning Grafana
- Datasource –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- Dashboard –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## üí° –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```go
github.com/prometheus/client_golang v1.23.2
github.com/prometheus/client_model v0.6.2
github.com/prometheus/common v0.66.1
```

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- Memory overhead: ~10-20MB
- CPU overhead: <1%
- Request latency overhead: ~0.1-0.5ms
- Metrics collection from DB: 30s interval

### Retention
- Prometheus: 7 –¥–Ω–µ–π
- Grafana: –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ (–∏—Å—Ç–æ—Ä–∏—è –≤ Prometheus)

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ —Ñ–∞–π–ª–∞—Ö:
- [MONITORING.md](MONITORING.md) - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ (7000+ —Å–ª–æ–≤)
- [QUICKSTART_METRICS.md](QUICKSTART_METRICS.md) - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- [METRICS_IMPLEMENTATION.md](METRICS_IMPLEMENTATION.md) - –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

## ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------------|--------|-------------|
| –í—ã–≥—Ä—É–∑–∫–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Prometheus | ‚úÖ | `/metrics` endpoint |
| 3 –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ | ‚úÖ | Request Rate, Duration, In-Flight |
| –õ–æ–≥–∏—á–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è | ‚úÖ | Time Series, Gauge, Bars |
| –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ª–µ–≥–µ–Ω–¥—ã | ‚úÖ | last, max, mean, sum, min |
| 3 –∫–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ | ‚úÖ | Users, Auth Operations, Sessions |
| –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ | ‚úÖ | 7 –ø–∞–Ω–µ–ª–µ–π –≤ Grafana |
| –°–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ | ‚úÖ | Gauge –º–µ—Ç—Ä–∏–∫–∏ —á–µ—Ä–µ–∑ –ë–î |

## üéâ –ò—Ç–æ–≥

–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω production-ready –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–ª—è SSO API:
- ‚úÖ –í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- ‚úÖ –ö–æ–¥ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞–ø–∏—Å–∞–Ω–∞
- ‚úÖ Docker Compose –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ Grafana Dashboard —Å–æ–∑–¥–∞–Ω
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ provisioning —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏! üöÄ**
